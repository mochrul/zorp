From: SZALAY Attila <sasa@debian.org>
Date: Fri, 3 Feb 2012 01:22:31 +0100
Subject: Removed all pre-related ifs from Makefiles and configure.in

---
 configure.in         |   47 +----------------------------------------------
 libproxy/Makefile.am |    7 -------
 zorp/Makefile.am     |    4 ----
 3 files changed, 1 insertion(+), 57 deletions(-)

diff --git a/configure.in b/configure.in
index cf5a259..4d4101c 100644
--- a/configure.in
+++ b/configure.in
@@ -13,7 +13,7 @@ AC_INIT(zorp/main.c)
 dnl ***************************************************************************
 dnl Definitions
 
-PACKAGE=zorp-pro
+PACKAGE=zorp
 BROCHURE_VERSION="3.9"
 VERSION=`cat $srcdir/VERSION`
 ZORP_PRODUCT_NAME="Zorp Professional"
@@ -24,8 +24,6 @@ dnl Dependencies
 
 GLIB_MIN_VERSION="2.2.1"
 ZORPLL_MIN_VERSION="3.9.1.0"
-ZORPLIC_MIN_VERSION="3.9.1"
-ZORPMISC_MIN_VERSION="3.9.1"
 OPENSSL_MIN_VERSION="0.9.8"
 PYTHON_MIN_VERSION="2.6"
 
@@ -49,21 +47,6 @@ if test -r $srcdir/dist.conf; then
         source $srcdir/dist.conf
 fi
 
-if test -z "$ZORP_PACKAGE_LICENSE"; then
-        ZORP_PACKAGE_LICENSE="pro"
-fi
-
-if test "$ZORP_PACKAGE_LICENSE" = "gpl"; then
-        PACKAGE="zorp"
-        PACKAGE_SUFFIX=""
-elif test "$ZORP_PACKAGE_LICENSE" = "pro"; then
-        PACKAGE_SUFFIX="-pro"
-else
-        AC_ERROR(Invalid license type: %s)
-fi
-
-AM_CONDITIONAL(PRO, test x$ZORP_PACKAGE_LICENSE = xpro)
-
 AM_INIT_AUTOMAKE($PACKAGE, $VERSION, no-define)
 m4_ifdef([AM_SILENT_RULES],[AM_SILENT_RULES])
 
@@ -275,27 +258,6 @@ PKG_CHECK_MODULES(ZORPLL, zorplibll >= $ZORPLL_MIN_VERSION,,
 PKG_CHECK_MODULES(OPENSSL, openssl >= $OPENSSL_MIN_VERSION,,
         AC_MSG_ERROR(Cannot find OpenSSL library version >= $OPENSSL_MIN_VERSION: is pkg-config in path?))
 
-if test "$ZORP_PACKAGE_LICENSE" = "pro"; then
-
-	save_CPPFLAGS=$CPPFLAGS
-	CPPFLAGS="$CPPFLAGS $OPENSSL_CFLAGS"
-	AC_CHECK_HEADER(openssl/ts.h, [], [AC_MSG_ERROR([OpenSSL header file <openssl/ts.h> is missing])])
-	CPPFLAGS=$save_CPPFLAGS
-
-	PKG_CHECK_MODULES(ZORPLIC, libzlicense >= $ZORPLIC_MIN_VERSION,,
-		AC_MSG_ERROR(Cannot find ZORP license library version >= $ZORPLIC_MIN_VERSION: is pkg-config in path?))
-
-	PKG_CHECK_MODULES(ZORPMISC, libzmisc >= $ZORPMISC_MIN_VERSION,,
-		AC_MSG_ERROR(Cannot find Zorp Misc library version >= $ZORPMISC_MIN_VERSION: is pkg-config in path?))
-
-	AC_CHECK_LIB(pcap, pcap_open_live, PCAP_LIBS="$PCAP_LIBS -lpcap")
-
-	AC_CHECK_HEADERS(google/coredumper.h)
-	AC_CHECK_LIB(coredumper, WriteCoreDump, COREDUMP_LIBS="$COREDUMP_LIBS -lcoredumper")
-
-fi
-
-
 dnl
 dnl Locating Python libraries
 dnl  
@@ -426,10 +388,6 @@ AC_SUBST(BROCHURE_VERSION)
 AC_SUBST(SNAPSHOT_VERSION)
 AC_SUBST(SOURCE_REVISION)
 
-AC_SUBST(ZORP_PACKAGE_LICENSE)
-AC_SUBST(PACKAGE_SUFFIX)
-
-AC_DEFINE_UNQUOTED(ZORP_LICENSE_VERSION, "$ZORP_LICENSE_VERSION", [Required license version])
 AC_DEFINE_UNQUOTED(ZORP_PRODUCT_NAME, "$ZORP_PRODUCT_NAME", [Required product name in license])
 
 AC_DEFINE_UNQUOTED(BROCHURE_VERSION, "$BROCHURE_VERSION", [Zorp brochure version])
@@ -517,7 +475,6 @@ coverage: $enable_coverage
 ipoptions: $enable_ip_options
 ipv6: $enable_ipv6
 prefork: $enable_prefork
-License: $ZORP_PACKAGE_LICENSE
 
 
 EOF
@@ -532,8 +489,6 @@ AC_SUBST(LIBZORP_LT_AGE)
 
 AC_SUBST(GLIB_MIN_VERSION)
 AC_SUBST(ZORPLL_MIN_VERSION)
-AC_SUBST(ZORPLIC_MIN_VERSION)
-AC_SUBST(ZORPMISC_MIN_VERSION)
 AC_SUBST(OPENSSL_MIN_VERSION)
 AC_SUBST(PYTHON_MIN_VERSION)
 AC_SUBST(CURRDATE)
diff --git a/libproxy/Makefile.am b/libproxy/Makefile.am
index 5ca68e8..3e4295d 100644
--- a/libproxy/Makefile.am
+++ b/libproxy/Makefile.am
@@ -3,13 +3,6 @@ SUBDIRS = zorp
 LIBS = @DEPS_LIBS@ @ZORP_LIBS@
 lib_LTLIBRARIES = libzorpproxy.la
 
-if PRO
-libzorpproxy_la_PRO_SOURCES =	\
-	polling_proxy.c
-else
-libzorpproxy_la_PRO_SOURCES =
-endif
-
 libzorpproxy_la_LDFLAGS = \
 	-release $(LIBZORP_LT_RELEASE) \
 	-export-dynamic	
diff --git a/zorp/Makefile.am b/zorp/Makefile.am
index 9f445fd..9f99958 100644
--- a/zorp/Makefile.am
+++ b/zorp/Makefile.am
@@ -2,10 +2,6 @@ pkglibdir=$(libdir)/zorp
 pkglibexecdir=$(libdir)/zorp
 LIBS=@ZORP_LIBS@
 
-if PRO
-SUBDIRS = urlfilter
-endif
-
 pkglibexec_PROGRAMS = zorp
 
 zorp_SOURCES = main.c 
