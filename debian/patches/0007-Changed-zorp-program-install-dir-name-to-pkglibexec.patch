From: SZALAY Attila <sasa@debian.org>
Date: Fri, 3 Feb 2012 00:25:54 +0100
Subject: Changed zorp program install dir name to pkglibexec

---
 ...1-Added-directory-to-make-configure-happy.patch |   17 -
 ...rp-program-install-dir-name-to-pkglibexec.patch |   27 ++
 ...2-Added-directory-to-make-configure-happy.patch |   17 +
 debian/patches/0002-zorpconfig_man.diff.patch      |   77 ---
 debian/patches/0003-openssl_1.0.diff.patch         |   30 --
 debian/patches/0003-zorpconfig_man.diff.patch      |   77 +++
 debian/patches/0004-compile_problems.patch         |  341 --------------
 debian/patches/0004-openssl_1.0.diff.patch         |   30 ++
 debian/patches/0005-compile_problems.patch         |  341 ++++++++++++++
 debian/patches/0005-compile_problems2.patch        |  485 --------------------
 debian/patches/0006-compile_problems2.patch        |  485 ++++++++++++++++++++
 debian/patches/series                              |   11 +-
 12 files changed, 983 insertions(+), 955 deletions(-)
 delete mode 100644 debian/patches/0001-Added-directory-to-make-configure-happy.patch
 create mode 100644 debian/patches/0001-Changed-zorp-program-install-dir-name-to-pkglibexec.patch
 create mode 100644 debian/patches/0002-Added-directory-to-make-configure-happy.patch
 delete mode 100644 debian/patches/0002-zorpconfig_man.diff.patch
 delete mode 100644 debian/patches/0003-openssl_1.0.diff.patch
 create mode 100644 debian/patches/0003-zorpconfig_man.diff.patch
 delete mode 100644 debian/patches/0004-compile_problems.patch
 create mode 100644 debian/patches/0004-openssl_1.0.diff.patch
 create mode 100644 debian/patches/0005-compile_problems.patch
 delete mode 100644 debian/patches/0005-compile_problems2.patch
 create mode 100644 debian/patches/0006-compile_problems2.patch

diff --git a/debian/patches/0001-Added-directory-to-make-configure-happy.patch b/debian/patches/0001-Added-directory-to-make-configure-happy.patch
deleted file mode 100644
index c948fb2..0000000
--- a/debian/patches/0001-Added-directory-to-make-configure-happy.patch
+++ /dev/null
@@ -1,17 +0,0 @@
-From: SZALAY Attila <sasa@debian.org>
-Date: Thu, 2 Feb 2012 22:06:07 +0100
-Subject: Added directory to make configure happy.
-
----
- tests/functional/anypy/info |    1 +
- 1 files changed, 1 insertions(+), 0 deletions(-)
- create mode 100644 tests/functional/anypy/info
-
-diff --git a/tests/functional/anypy/info b/tests/functional/anypy/info
-new file mode 100644
-index 0000000..14d9a62
---- /dev/null
-+++ b/tests/functional/anypy/info
-@@ -0,0 +1 @@
-+Base-Class: AnyPyProxy
--- 
diff --git a/debian/patches/0001-Changed-zorp-program-install-dir-name-to-pkglibexec.patch b/debian/patches/0001-Changed-zorp-program-install-dir-name-to-pkglibexec.patch
new file mode 100644
index 0000000..56801ec
--- /dev/null
+++ b/debian/patches/0001-Changed-zorp-program-install-dir-name-to-pkglibexec.patch
@@ -0,0 +1,27 @@
+From: SZALAY Attila <sasa@debian.org>
+Date: Fri, 3 Feb 2012 00:21:55 +0100
+Subject: Changed zorp program install dir name to pkglibexec.
+
+---
+ zorp/Makefile.am |    3 ++-
+ 1 files changed, 2 insertions(+), 1 deletions(-)
+
+diff --git a/zorp/Makefile.am b/zorp/Makefile.am
+index 522a0ca..e1814d5 100644
+--- a/zorp/Makefile.am
++++ b/zorp/Makefile.am
+@@ -1,11 +1,12 @@
+ pkglibdir=$(libdir)/zorp
++pkglibexecdir=$(libdir)/zorp
+ LIBS=@ZORP_LIBS@
+ 
+ if PRO
+ SUBDIRS = urlfilter
+ endif
+ 
+-pkglib_PROGRAMS = zorp
++pkglibexec_PROGRAMS = zorp
+ 
+ zorp_SOURCES = main.c 
+ 
+-- 
diff --git a/debian/patches/0002-Added-directory-to-make-configure-happy.patch b/debian/patches/0002-Added-directory-to-make-configure-happy.patch
new file mode 100644
index 0000000..c948fb2
--- /dev/null
+++ b/debian/patches/0002-Added-directory-to-make-configure-happy.patch
@@ -0,0 +1,17 @@
+From: SZALAY Attila <sasa@debian.org>
+Date: Thu, 2 Feb 2012 22:06:07 +0100
+Subject: Added directory to make configure happy.
+
+---
+ tests/functional/anypy/info |    1 +
+ 1 files changed, 1 insertions(+), 0 deletions(-)
+ create mode 100644 tests/functional/anypy/info
+
+diff --git a/tests/functional/anypy/info b/tests/functional/anypy/info
+new file mode 100644
+index 0000000..14d9a62
+--- /dev/null
++++ b/tests/functional/anypy/info
+@@ -0,0 +1 @@
++Base-Class: AnyPyProxy
+-- 
diff --git a/debian/patches/0002-zorpconfig_man.diff.patch b/debian/patches/0002-zorpconfig_man.diff.patch
deleted file mode 100644
index 19be283..0000000
--- a/debian/patches/0002-zorpconfig_man.diff.patch
+++ /dev/null
@@ -1,77 +0,0 @@
-From: SZALAY Attila <sasa@debian.org>
-Date: Thu, 2 Feb 2012 22:18:55 +0100
-Subject: zorpconfig_man.diff
-
-===================================================================
----
- doc/man/zorp-config.1 |   60 +++++++++++++++++++++++++++++++++++++++++++++++++
- 1 files changed, 60 insertions(+), 0 deletions(-)
- create mode 100644 doc/man/zorp-config.1
-
-diff --git a/doc/man/zorp-config.1 b/doc/man/zorp-config.1
-new file mode 100644
-index 0000000..9b6ef36
---- /dev/null
-+++ b/doc/man/zorp-config.1
-@@ -0,0 +1,60 @@
-+.\" Copyright (c) 2003-2004 BalaBit IT Ltd.
-+.TH ZORP-CONFIG 5 "March 10, 2004"
-+.SH NAME
-+zorp-config \- Zorp compilation environment
-+.SH SYNOPSIS
-+zorp-config [\-\-prefix\fI[=DIR]\fP] [\-\-exec\-prefix\fI[=DIR]\fP] [\-\-version] [\-\-libs] [\-\-cflags]
-+.SH DESCRIPTION
-+
-+Zorp is a new generation proxy firewall suite for Unix based operating
-+systems. 
-+
-+\fIzorp-config\fP is a tool that is used to configure to determine
-+the compiler and linker flags that should be used to compile Zorp modules.
-+
-+.SH OPTIONS
-+
-+.TP
-+.B --prefix
-+
-+.TP
-+.B --exec-prefix
-+
-+.TP
-+.B --version
-+
-+.TP
-+.B --cppflags
-+
-+.TP
-+.B --cflags
-+
-+.TP
-+.B --libs
-+
-+.TP
-+.B --local-cppflags
-+
-+.TP
-+.B --local-cflags
-+
-+.TP
-+.B --local-libs
-+
-+.TP
-+.B --datadir
-+
-+.TP
-+.B --moduledir
-+
-+.TP
-+.B --trace
-+
-+.TP
-+.B --debug
-+
-+.SH SEE ALSO
-+.BR zorp (8)
-+.SH AUTHOR
-+This manual page was written by Árpád Magosányi <mag@debian.org> and Balázs
-+Scheidler <bazsi@balabit.hu>.
--- 
diff --git a/debian/patches/0003-openssl_1.0.diff.patch b/debian/patches/0003-openssl_1.0.diff.patch
deleted file mode 100644
index ffcd85f..0000000
--- a/debian/patches/0003-openssl_1.0.diff.patch
+++ /dev/null
@@ -1,30 +0,0 @@
-From: SZALAY Attila <sasa@debian.org>
-Date: Thu, 2 Feb 2012 22:18:55 +0100
-Subject: openssl_1.0.diff
-
-===================================================================
----
- lib/proxyssl.c |    2 ++
- 1 files changed, 2 insertions(+), 0 deletions(-)
-
-diff --git a/lib/proxyssl.c b/lib/proxyssl.c
-index e7c8eba..58d63b9 100644
---- a/lib/proxyssl.c
-+++ b/lib/proxyssl.c
-@@ -1282,6 +1282,7 @@ z_proxy_ssl_setup_handshake(ZProxySSLHandshake *handshake)
-       else
-         ctx = SSL_CTX_new(SSLv23_client_method());
-     }
-+#ifndef OPENSSL_NO_SSL2
-   else if (strcmp(self->ssl_opts.ssl_method[side]->str, "SSLv2") == 0)
-     {
-       if (side == EP_CLIENT)
-@@ -1289,6 +1290,7 @@ z_proxy_ssl_setup_handshake(ZProxySSLHandshake *handshake)
-       else
-         ctx = SSL_CTX_new(SSLv2_client_method());
-     }
-+#endif
-   else if (strcmp(self->ssl_opts.ssl_method[side]->str, "SSLv3") == 0)
-     {
-       if (side == EP_CLIENT)
--- 
diff --git a/debian/patches/0003-zorpconfig_man.diff.patch b/debian/patches/0003-zorpconfig_man.diff.patch
new file mode 100644
index 0000000..19be283
--- /dev/null
+++ b/debian/patches/0003-zorpconfig_man.diff.patch
@@ -0,0 +1,77 @@
+From: SZALAY Attila <sasa@debian.org>
+Date: Thu, 2 Feb 2012 22:18:55 +0100
+Subject: zorpconfig_man.diff
+
+===================================================================
+---
+ doc/man/zorp-config.1 |   60 +++++++++++++++++++++++++++++++++++++++++++++++++
+ 1 files changed, 60 insertions(+), 0 deletions(-)
+ create mode 100644 doc/man/zorp-config.1
+
+diff --git a/doc/man/zorp-config.1 b/doc/man/zorp-config.1
+new file mode 100644
+index 0000000..9b6ef36
+--- /dev/null
++++ b/doc/man/zorp-config.1
+@@ -0,0 +1,60 @@
++.\" Copyright (c) 2003-2004 BalaBit IT Ltd.
++.TH ZORP-CONFIG 5 "March 10, 2004"
++.SH NAME
++zorp-config \- Zorp compilation environment
++.SH SYNOPSIS
++zorp-config [\-\-prefix\fI[=DIR]\fP] [\-\-exec\-prefix\fI[=DIR]\fP] [\-\-version] [\-\-libs] [\-\-cflags]
++.SH DESCRIPTION
++
++Zorp is a new generation proxy firewall suite for Unix based operating
++systems. 
++
++\fIzorp-config\fP is a tool that is used to configure to determine
++the compiler and linker flags that should be used to compile Zorp modules.
++
++.SH OPTIONS
++
++.TP
++.B --prefix
++
++.TP
++.B --exec-prefix
++
++.TP
++.B --version
++
++.TP
++.B --cppflags
++
++.TP
++.B --cflags
++
++.TP
++.B --libs
++
++.TP
++.B --local-cppflags
++
++.TP
++.B --local-cflags
++
++.TP
++.B --local-libs
++
++.TP
++.B --datadir
++
++.TP
++.B --moduledir
++
++.TP
++.B --trace
++
++.TP
++.B --debug
++
++.SH SEE ALSO
++.BR zorp (8)
++.SH AUTHOR
++This manual page was written by Árpád Magosányi <mag@debian.org> and Balázs
++Scheidler <bazsi@balabit.hu>.
+-- 
diff --git a/debian/patches/0004-compile_problems.patch b/debian/patches/0004-compile_problems.patch
deleted file mode 100644
index 02b96ab..0000000
--- a/debian/patches/0004-compile_problems.patch
+++ /dev/null
@@ -1,341 +0,0 @@
-From: SZALAY Attila <sasa@debian.org>
-Date: Thu, 2 Feb 2012 22:18:55 +0100
-Subject: compile_problems
-
-===================================================================
----
- lib/proxyssl.c          |    2 +-
- lib/proxystack.c        |    5 +----
- lib/pyattach.c          |    4 ++--
- lib/pycore.c            |   10 +++++-----
- lib/pydict.c            |    2 +-
- lib/pydispatch.c        |    4 ++--
- lib/pyproxygroup.c      |    2 +-
- lib/pystream.c          |    4 ++--
- lib/pyx509.c            |    8 ++++----
- lib/zorp/policy.h       |    2 ++
- modules/anypy/anypy.c   |    2 +-
- modules/finger/finger.c |    6 ++----
- modules/ftp/ftpcmd.c    |    4 ++--
- modules/http/http.c     |    4 ++--
- 14 files changed, 28 insertions(+), 31 deletions(-)
-
-diff --git a/lib/proxyssl.c b/lib/proxyssl.c
-index 58d63b9..61fba65 100644
---- a/lib/proxyssl.c
-+++ b/lib/proxyssl.c
-@@ -588,7 +588,7 @@ z_proxy_ssl_load_local_ca_list(ZProxySSLHandshake *handshake)
-       if (!sk)
-         z_proxy_return(self, FALSE);
- 
--      n = sk_X509_NAME_num(self->ssl_opts.local_ca_list[ndx]);
